(this["webpackJsonpchatrooms-client"]=this["webpackJsonpchatrooms-client"]||[]).push([[0],{117:function(e,t,a){},118:function(e,t,a){"use strict";a.r(t);var r=a(1),n=a.n(r),s=a(58),c=a.n(s),o=a(3),i=a(15),l=a(2),u=function(e,t){return e.length<=t?e:"".concat(e.slice(0,t),"...")},m=a(0),j=function(e){var t=e.displayName,a=t?u(t,10):"Login";return Object(m.jsx)("div",{className:"navbar",children:Object(m.jsxs)("div",{className:"navbar__items",children:[Object(m.jsx)(i.b,{className:"navbar__title",to:t?"/rooms":"/login",children:Object(m.jsx)("h1",{children:"Chatrooms"})}),Object(m.jsxs)("div",{className:"navbar__links",children:[t&&Object(m.jsx)(i.b,{className:"navbar__link",to:"/rooms",children:"Rooms"}),Object(m.jsx)(i.b,{className:"navbar__link",to:"/login",children:a})]})]})})},b=function(){var e="chatroomsDisplayName",t=window.localStorage.getItem(e)||"",a=Object(r.useState)(""),n=Object(o.a)(a,2),s=n[0],c=n[1],i=Object(r.useState)(t),l=Object(o.a)(i,2);return[s,function(t){window.localStorage.setItem(e,t),c(t)},l[0],l[1]]},d=function(e,t){var a=Object(r.useState)([]),n=Object(o.a)(a,2),s=n[0],c=n[1];return Object(r.useEffect)((function(){t&&e.on("rooms",(function(e){c(e)}),[t])})),[s,c]},O=a(60),p=a.n(O),h=function(){var e=Object(r.useState)(null),t=Object(o.a)(e,2),a=t[0],n=t[1],s=null!==a&&a.connected;return Object(r.useEffect)((function(){var e=p()("http://127.0.0.1:5000");return e.on("connect",(function(){n(e)})),function(){e.disconnect()}}),[]),[a,s]},x=a(8),f=a.n(x),v=a(16),_=a(24),N=a.n(_),g="http://localhost:5000",k=function(){var e=Object(v.a)(f.a.mark((function e(t,a,r){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.a.post("".concat(g,"/login"),{displayName:a,socketId:t.id});case 2:return n=e.sent,r(n.data.rooms),e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),y=function(e){var t=e.displayNameInput,a=e.setDisplayNameInput,n=e.setDisplayName,s=e.connected,c=e.socket,i=e.setRooms,u=Object(r.useState)(!1),j=Object(o.a)(u,2),b=j[0],d=j[1],O=Object(r.useState)(""),p=Object(o.a)(O,2),h=p[0],x=p[1],_=""===t,N=function(){var e=Object(v.a)(f.a.mark((function e(a){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),!_){e.next=3;break}return e.abrupt("return");case 3:if(s){e.next=5;break}return e.abrupt("return",x("Server error"));case 5:return e.prev=5,e.next=8,k(c,t,i);case 8:if((r=e.sent).created){e.next=11;break}return e.abrupt("return",x(r.message));case 11:n(t),d(!0),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),x("Server error");case 18:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(t){return e.apply(this,arguments)}}();return b?Object(m.jsx)(l.a,{to:"/rooms",push:!0}):Object(m.jsxs)("div",{className:"login",children:[Object(m.jsx)("h1",{className:"login__title",children:"Set Your Display Name"}),Object(m.jsxs)("form",{className:"login__form",children:[Object(m.jsx)("input",{type:"text",className:"login__input input",value:t,onChange:function(e){return a(e.target.value)},placeholder:"Enter your display name here"}),h&&Object(m.jsx)("div",{className:"login__error error",children:h}),Object(m.jsx)("button",{disabled:_,className:"button",onClick:N,children:"View Rooms"})]})]})},S=function(e){var t=e.rooms,a=e.socket,n=e.displayName,s=Object(r.useState)(""),c=Object(o.a)(s,2),i=c[0],j=c[1],b=Object(l.g)().roomName,d=t.find((function(e){return e.roomName===b}));return d?Object(m.jsxs)("div",{className:"room",children:[Object(m.jsx)("div",{className:"room__messages",children:d.messages.map((function(e){var t=e.displayName===n?"room__author room__author--right":"room__author room__author--left",a=e.displayName===n?"room__message room__message--right":"room__message room__message--left";return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("div",{className:t,children:u(e.displayName,15)}),Object(m.jsx)("div",{className:a,children:e.content})]})}))}),Object(m.jsxs)("div",{className:"room__send",children:[Object(m.jsx)("textarea",{value:i,onChange:function(e){return j(e.target.value)},className:"room__input input"}),Object(m.jsx)("button",{className:"room__button button",onClick:function(e){e.preventDefault(),a.emit("message",{roomName:b,content:i,socketId:a.id})},children:"Send"})]})]}):Object(m.jsx)(l.a,{to:n?"/rooms":"/login"})},w=function(){var e=Object(v.a)(f.a.mark((function e(t,a){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.a.post("".concat(g,"/room"),{roomName:a,socketId:t.id});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),I=function(e){var t=e.socket,a=Object(r.useState)(""),n=Object(o.a)(a,2),s=n[0],c=n[1],i=Object(r.useState)(""),l=Object(o.a)(i,2),u=l[0],j=l[1],b=Object(r.useState)(""),d=Object(o.a)(b,2),O=d[0],p=d[1],h=function(){var e=Object(v.a)(f.a.mark((function e(a){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.next=3,w(t,s);case 3:(r=e.sent).created?(p(r.message),j(""),c("")):(j(r.message),p(""));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsxs)("div",{className:"create-room half-page",children:[Object(m.jsx)("h1",{className:"create-room__title",children:"Create Room"}),Object(m.jsxs)("form",{className:"create-room__form",children:[Object(m.jsx)("input",{value:s,type:"text",className:"create-room__input input",onChange:function(e){p(""),c(e.target.value)}}),u&&Object(m.jsx)("div",{className:"error",children:u}),O&&Object(m.jsx)("div",{className:"success",children:O}),Object(m.jsx)("button",{className:"create-room__button button",onClick:h,children:"Create Room"})]})]})},C=function(e){var t=e.rooms;return Object(m.jsxs)("div",{className:"rooms-list half-page",children:[Object(m.jsx)("h1",{className:"rooms-list__title",children:"Rooms"}),Object(m.jsx)("div",{className:"rooms-list__list",children:t.map((function(e,t){return Object(m.jsx)(i.b,{className:"rooms-list__button button",to:"/rooms/".concat(e.roomName),children:u(e.roomName,10)},t)}))})]})},D=function(e){var t=e.socket,a=e.rooms;return Object(m.jsxs)("div",{className:"rooms-page",children:[Object(m.jsx)(I,{socket:t}),Object(m.jsx)(C,{rooms:a})]})},R=function(){var e=b(),t=Object(o.a)(e,4),a=t[0],r=t[1],n=t[2],s=t[3],c=h(),u=Object(o.a)(c,2),O=u[0],p=u[1],x=d(O,p),f=Object(o.a)(x,2),v=f[0],_=f[1];return Object(m.jsxs)(i.a,{children:[Object(m.jsx)(j,{displayName:a}),Object(m.jsxs)(l.d,{children:[Object(m.jsx)(l.b,{exact:!0,path:"/login",children:Object(m.jsx)(y,{setRooms:_,socket:O,connected:p,displayNameInput:n,setDisplayNameInput:s,setDisplayName:r})}),Object(m.jsxs)(l.b,{exact:!0,path:"/rooms",children:[a?null:Object(m.jsx)(l.a,{to:"/login"}),Object(m.jsx)(D,{socket:O,rooms:v})]}),Object(m.jsxs)(l.b,{exact:!0,path:"/rooms/:roomName",children:[a?null:Object(m.jsx)(l.a,{to:"/login"}),Object(m.jsx)(S,{rooms:v,socket:O,displayName:a})]}),Object(m.jsx)(l.b,{exact:!0,path:"",children:Object(m.jsx)(l.a,{to:"/login"})})]})]})};a(117);c.a.render(Object(m.jsx)(n.a.StrictMode,{children:Object(m.jsx)(R,{})}),document.getElementById("root"))}},[[118,1,2]]]);
//# sourceMappingURL=main.a7875f1e.chunk.js.map